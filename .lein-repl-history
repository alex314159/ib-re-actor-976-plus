(ns ib-re-actor-976-plus.gateway)
twsversion
exit
(ns wrapper.clj)
(camel-to-kebab "helloSexy")
(require '[ib-re-actor-976-plus.wrapper :as wrapper])
(wrapper/tws-version )
wrapper/tws-version
(require '[ib-re-actor-976-plus.wrapper :as wrapper])
wrapper/tws-version 
(:require [ib-re-actor-976-plus.gateway :as gateway]
            [ib-re-actor-976-plus.mapping :refer [map->]]
            [ib-re-actor-976-plus.client-socket :as cs]))
(ns ib-re-actor-976-plus.demoapps.basic-app
  (:require [ib-re-actor-976-plus.gateway :as gateway]
            [ib-re-actor-976-plus.mapping :refer [map->]]
            [ib-re-actor-976-plus.client-socket :as cs]))
(def account "U1217609")
def requests (atom 0))                                     ; this is the counter for IB requests
(def default-port 7496)
(def requests (atom 0))
(def connection (gateway/connect 2 "localhost" default-paper-port println)) ;you may need to change the port
(def connection (gateway/connect 2 "localhost" default-port println)) ;you may need to change the port
(def ESU0-map {:symbol "ES" :sec-type "FUT" :exchange "GLOBEX" :currency "USD" :last-trade-date-or-contract-month "20211217"})
(defn example-historical-request []
  (cs/request-historical-data
    (:ecs connection)
    (swap! requests inc)
    ESU0-map
    "20200420 0:00:00"                                      ;the format is important. It defaults to TWS timezone if not specified
    10 :days
    1 :day
    :trades
    true
    1
    false))
(example-historical-request )
(defn example-historical-request []
  (cs/request-historical-data
    (:ecs connection)
    (swap! requests inc)
    ESU0-map
    "20210920 0:00:00"                                      ;the format is important. It defaults to TWS timezone if not specified
    10 :days
    1 :day
    :trades
    true
    1
    false))
(example-historical-request )
(require '[ib-re-actor-976-plus.wrapper :as w])
(println "Loaded successfully!")
(println "Method count (old):" (count w/ewrapper-java-methods))
(println "Method count (new):" (count w/ewrapper-methods))
(println "\nFirst 3 JavaParser methods:")
(clojure.pprint/pprint (take 3 w/ewrapper-methods))
(println "\nError methods count:" (count (filter w/error-method? w/ewrapper-methods)))
(System/exit 0)
(require '[ib-re-actor-976-plus.wrapper :as w])
(println "✓ Loaded successfully!")
(println "\nMethod count comparison:")
(println "  OLD (text-based):" (count w/ewrapper-java-methods))
(println "  NEW (JavaParser): " (count w/ewrapper-methods))
(println "\nFirst JavaParser method:")
(clojure.pprint/pprint (first w/ewrapper-methods))
(println "\nError methods found:" (count (filter w/error-method? w/ewrapper-methods)))
(System/exit 0)
(require '[ib-re-actor-976-plus.wrapper :as w])
(println "✓ Loaded successfully!")
(println "\nMethod count comparison:")
(println "  OLD (text-based):" (count w/ewrapper-java-methods))
(println "  NEW (JavaParser): " (count w/ewrapper-methods))
(println "\nFirst JavaParser method:")
(clojure.pprint/pprint (first w/ewrapper-methods))
(println "\nError methods found:" (count (filter w/error-method? w/ewrapper-methods)))
(println "\n✓ All tests passed!")
(System/exit 0)
(require '[ib-re-actor-976-plus.wrapper :as w])
(println "✓ Loaded successfully!")
(println "\nMethod count comparison:")
(println "  OLD (text-based):" (count w/ewrapper-java-methods))
(println "  NEW (JavaParser): " (count w/ewrapper-methods))
(println "  Non-error methods:" (count w/non-error-methods))
(println "\nFirst JavaParser method:")
(clojure.pprint/pprint (first w/ewrapper-methods))
(println "\nError methods found:" (count (filter w/error-method? w/ewrapper-methods)))
(println "\n✓ All tests passed!")
(System/exit 0)
(require '[ib-re-actor-976-plus.wrapper :as w])
(println "✓ Loaded successfully!")
(println "\nMethod count comparison:")
(println "  OLD (text-based):" (count w/ewrapper-java-methods))
(println "  NEW (JavaParser): " (count w/ewrapper-methods))
(println "  Non-error methods:" (count w/non-error-methods))
(println "\nFirst JavaParser method:")
(clojure.pprint/pprint (first w/ewrapper-methods))
(println "\nError methods found:" (count (filter w/error-method? w/ewrapper-methods)))
(println "\n✓✓✓ SUCCESS! Both implementations loaded correctly! ✓✓✓")
(System/exit 0)
(require '[ib-re-actor-976-plus.wrapper :as w])
(println "✓ Loaded successfully with return type hints!")
(println "\nFirst method with type hint:")
(let [first-method (first w/non-error-methods)
      impl (w/generate-method-impl first-method)]
  (println "Method:" (:name first-method))
  (println "Return type:" (:return-type first-method))
  (println "Generated impl (first 2 elements):")
  (clojure.pprint/pprint (take 2 impl)))
(println "\n✓✓✓ SUCCESS! Return type hints working! ✓✓✓")
(System/exit 0)
(require '[ib-re-actor-976-plus.wrapper :as w])
(println "✓ Back to working implementation!")
(println "\nKey insight: Type hints DON'T help for interface implementation")
(println "They only help for:")
(println "  1. Calling Java methods (avoid reflection)")
(println "  2. Overloaded methods (distinguishing signatures)")
(System/exit 0)
